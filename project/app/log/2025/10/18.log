18.10.2025 17:53:11 startup: Импорты main.py выполнены
18.10.2025 17:53:12 startup: Запуск uvicorn.run
18.10.2025 17:53:16 startup: lifespan: startup начат
18.10.2025 17:53:16 startup: База инициализирована
18.10.2025 17:53:17 startup: Base добавлен в app.state
18.10.2025 17:53:17 startup: Async Log инициализирован
18.10.2025 17:53:29 shutdown: Остановка приложения
18.10.2025 17:53:29 shutdown: Log корректно завершён
18.10.2025 17:53:45 startup: Импорты main.py выполнены
18.10.2025 17:53:45 startup: Запуск uvicorn.run
18.10.2025 17:53:48 startup: lifespan: startup начат
18.10.2025 17:53:48 startup: База инициализирована
18.10.2025 17:53:50 startup: Base добавлен в app.state
18.10.2025 17:53:50 startup: Async Log инициализирован
18.10.2025 17:54:44 auth: Токен выдан успешно: {'username': 'admin'}
18.10.2025 17:55:01 auth: Токен проверен: admin
18.10.2025 17:55:01 lead: Лид загружен: {'id': 1}
18.10.2025 17:55:02 lead: Лид обновлён: {'id': 1}
18.10.2025 17:55:02 dialog: Лид очищен: {'lead_id': 1}
18.10.2025 17:55:02 dialog: История диалога очищена: {'client_id': 1}
18.10.2025 17:55:56 auth: Токен проверен: admin
18.10.2025 17:55:56 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 17:55:56 lead: Лид загружен: {'id': 1}
18.10.2025 17:55:56 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 17:55:56 dialog_step: : {'user': 'Привет'}
18.10.2025 17:55:56 hello_stage: Сформирован промпт приветствия: {'step': 0, 'client_id': 1}
18.10.2025 17:55:56 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 17:55:58 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 17:55:59 dialog_step: : {'step_after': 1, 'motive': None}
18.10.2025 17:55:59 dialog_step: : {'model': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами для комфорта и расслабления. Что в креслах для вас наиболее важно: комфорт, дизайн или цена?'}
18.10.2025 17:55:59 lead: Лид обновлён: {'id': 1}
18.10.2025 17:55:59 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами для комфорта и расслабления. Что в креслах для вас наиболее важно: комфорт, дизайн или цена?'}
18.10.2025 17:55:59 dialog_step: END step(): {'result': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами для комфорта и расслабления. Что в креслах для вас наиболее важно: комфорт, дизайн или цена?'}
18.10.2025 17:55:59 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 17:56:31 auth: Токен проверен: admin
18.10.2025 17:56:31 dialog_step: START step(): {'client_id': 1, 'user_input': 'Цена'}
18.10.2025 17:56:31 lead: Лид загружен: {'id': 1}
18.10.2025 17:56:31 dialog_step: : {'step_before': 1, 'motive': None}
18.10.2025 17:56:31 dialog_step: : {'user': 'Цена'}
18.10.2025 17:56:31 hello_stage: Сформирован промпт приветствия: {'step': 1, 'client_id': 1}
18.10.2025 17:56:31 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 17:56:32 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 17:56:33 dialog_step: : {'step_after': 1, 'motive': None}
18.10.2025 17:56:33 dialog_step: : {'model': 'Цена наших кресел варьируется в зависимости от модели и функциональности. Какой ценовой диапазон вас интересует?'}
18.10.2025 17:56:33 lead: Лид обновлён: {'id': 1}
18.10.2025 17:56:33 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Цена наших кресел варьируется в зависимости от модели и функциональности. Какой ценовой диапазон вас интересует?'}
18.10.2025 17:56:33 dialog_step: END step(): {'result': 'Цена наших кресел варьируется в зависимости от модели и функциональности. Какой ценовой диапазон вас интересует?'}
18.10.2025 17:56:33 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 17:56:42 auth: Токен проверен: admin
18.10.2025 17:56:42 dialog_step: START step(): {'client_id': 1, 'user_input': 'Низкий'}
18.10.2025 17:56:42 lead: Лид загружен: {'id': 1}
18.10.2025 17:56:42 dialog_step: : {'step_before': 1, 'motive': None}
18.10.2025 17:56:42 dialog_step: : {'user': 'Низкий'}
18.10.2025 17:56:42 hello_stage: Сформирован промпт приветствия: {'step': 1, 'client_id': 1}
18.10.2025 17:56:42 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 17:56:43 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 17:56:44 dialog_step: : {'step_after': 1, 'motive': None}
18.10.2025 17:56:44 dialog_step: : {'model': 'Какой максимальный бюджет вы планируете выделить на покупку кресла? Это поможет мне подобрать наиболее подходящие варианты.'}
18.10.2025 17:56:44 lead: Лид обновлён: {'id': 1}
18.10.2025 17:56:44 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Какой максимальный бюджет вы планируете выделить на покупку кресла? Это поможет мне подобрать наиболее подходящие варианты.'}
18.10.2025 17:56:44 dialog_step: END step(): {'result': 'Какой максимальный бюджет вы планируете выделить на покупку кресла? Это поможет мне подобрать наиболее подходящие варианты.'}
18.10.2025 17:56:44 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 17:56:51 auth: Токен проверен: admin
18.10.2025 17:56:51 dialog_step: START step(): {'client_id': 1, 'user_input': '50000'}
18.10.2025 17:56:51 lead: Лид загружен: {'id': 1}
18.10.2025 17:56:51 dialog_step: : {'step_before': 1, 'motive': None}
18.10.2025 17:56:51 dialog_step: : {'user': '50000'}
18.10.2025 17:56:51 hello_stage: Сформирован промпт приветствия: {'step': 1, 'client_id': 1}
18.10.2025 17:56:51 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 17:56:52 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 17:56:54 dialog_step: : {'step_after': 2, 'motive': None}
18.10.2025 17:56:54 dialog_step: : {'model': 'Спасибо за информацию! У нас есть несколько моделей кресел в пределах вашего бюджета. Вам интересны массажные функции в кресле или вы предпочитаете более простые модели?'}
18.10.2025 17:56:54 lead: Лид обновлён: {'id': 1}
18.10.2025 17:56:54 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Спасибо за информацию! У нас есть несколько моделей кресел в пределах вашего бюджета. Вам интересны массажные функции в кресле или вы предпочитаете более простые модели?'}
18.10.2025 17:56:54 dialog_step: END step(): {'result': 'Спасибо за информацию! У нас есть несколько моделей кресел в пределах вашего бюджета. Вам интересны массажные функции в кресле или вы предпочитаете более простые модели?'}
18.10.2025 17:56:54 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 17:57:07 auth: Токен проверен: admin
18.10.2025 17:57:07 dialog_step: START step(): {'client_id': 1, 'user_input': 'Простые'}
18.10.2025 17:57:07 lead: Лид загружен: {'id': 1}
18.10.2025 17:57:07 dialog_step: : {'step_before': 2, 'motive': None}
18.10.2025 17:57:07 dialog_step: : {'user': 'Простые'}
18.10.2025 17:57:07 hello_stage: Сформирован промпт приветствия: {'step': 2, 'client_id': 1}
18.10.2025 17:57:07 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 17:57:08 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 17:57:11 dialog_step: : {'step_after': 3, 'motive': 'расслабление после работы'}
18.10.2025 17:57:11 dialog_step: : {'model': 'Спасибо за информацию! Я вижу, что вы интересуетесь простыми моделями кресел. Это поможет вам расслабиться после работы и создать комфортную обстановку. Пишите, если у вас будут вопросы, наш консультант поможет вам с выбором кресел.'}
18.10.2025 17:57:11 lead: Лид обновлён: {'id': 1}
18.10.2025 17:57:11 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Спасибо за информацию! Я вижу, что вы интересуетесь простыми моделями кресел. Это поможет вам расслабиться после работы и создать комфортную обстановку. Пишите, если у вас будут вопросы, наш консультант поможет вам с выбором кресел.'}
18.10.2025 17:57:11 dialog_step: END step(): {'result': 'Спасибо за информацию! Я вижу, что вы интересуетесь простыми моделями кресел. Это поможет вам расслабиться после работы и создать комфортную обстановку. Пишите, если у вас будут вопросы, наш консультант поможет вам с выбором кресел.'}
18.10.2025 17:57:11 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 17:59:47 auth: Токен проверен: admin
18.10.2025 17:59:47 dialog_step: START step(): {'client_id': 1, 'user_input': 'Какие виды кресел для расслабления'}
18.10.2025 17:59:47 lead: Лид загружен: {'id': 1}
18.10.2025 17:59:47 dialog_step: : {'step_before': 3, 'motive': 'расслабление после работы'}
18.10.2025 17:59:47 dialog_step: : {'user': 'Какие виды кресел для расслабления'}
18.10.2025 17:59:47 consultant_stage: Сформирована инструкция для консультанта: {'client_id': 1}
18.10.2025 17:59:47 dispatcher: Выбранный агент: consultant: {'client_id': 1}
18.10.2025 17:59:49 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 17:59:55 dialog_step: : {'step_after': 3, 'motive': 'расслабление после работы'}
18.10.2025 17:59:55 dialog_step: : {'model': 'Существуют несколько видов кресел для расслабления, которые могут помочь вам восстановиться после тяжелого дня на работе:\n\n1. **Массажные кресла**: Эти кресла предлагают разнообразные массажные функции, включая Shiatsu, роликовый массаж и различных режимов интенсивности, что позволяет настраивать массаж под ваши предпочтения. Они помогают снять напряжение и расслабить мышцы.\n\n2. **Реклайнеры**: Эти кресла могут наклоняться назад и обеспечивают хороший уровень комфорта. Они идеальны для отдыха и могут быть использованы как для просмотра телевизора, так и для сна.\n\n3. **Кресла-качалки**: Они обеспечивают плавное движение вперед-назад, что создает успокаивающий эффект и помогает расслабиться.\n\n4. **Кресла с подогревом**: Эти модели сочетает в себе массажные функции и подогрев, что еще больше усиливает эффект расслабления.\n\nПри выборе кресла рекомендуется учитывать следующие моменты:\n- **Массажные функции**: Если вы будете активно использовать массаж, присмотритесь к моделям с разнообразными режимами и возможностью настройки.\n- **Комфорт**: Обратите внимание на материал обивки и поддержку тела, чтобы кресло подходило вам по размеру.\n- **Дизайн**: Выбирайте кресло, которое гармонично впишется в ваш интерьер.\n\nИ наконец, если вы рассматриваете массажные кресла, следует выяснить, нужно ли вам больше массажных функций или вам достаточно простого кресла для отдыха. Какой тип кресла вас интересует больше?'}
18.10.2025 17:59:55 lead: Лид обновлён: {'id': 1}
18.10.2025 17:59:55 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Существуют несколько видов кресел для расслабления, которые могут помочь вам восстановиться после тяжелого дня на работе:\n\n1. **Массажные кресла**: Эти кресла предлагают разнообразные массажные функции, включая Shiatsu, роликовый массаж и различных режимов интенсивности, что позволяет настраивать массаж под ваши предпочтения. Они помогают снять напряжение и расслабить мышцы.\n\n2. **Реклайнеры**: Эти кресла могут наклоняться назад и обеспечивают хороший уровень комфорта. Они идеальны для отдыха и могут быть использованы как для просмотра телевизора, так и для сна.\n\n3. **Кресла-качалки**: Они обеспечивают плавное движение вперед-назад, что создает успокаивающий эффект и помогает расслабиться.\n\n4. **Кресла с подогревом**: Эти модели сочетает в себе массажные функции и подогрев, что еще больше усиливает эффект расслабления.\n\nПри выборе кресла рекомендуется учитывать следующие моменты:\n- **Массажные функции**: Если вы будете активно использовать массаж, присмотритесь к моделям с разнообразными режимами и возможностью настройки.\n- **Комфорт**: Обратите внимание на материал обивки и поддержку тела, чтобы кресло подходило вам по размеру.\n- **Дизайн**: Выбирайте кресло, которое гармонично впишется в ваш интерьер.\n\nИ наконец, если вы рассматриваете массажные кресла, следует выяснить, нужно ли вам больше массажных функций или вам достаточно простого кресла для отдыха. Какой тип кресла вас интересует больше?'}
18.10.2025 17:59:55 dialog_step: END step(): {'result': 'Существуют несколько видов кресел для расслабления, которые могут помочь вам восстановиться после тяжелого дня на работе:\n\n1. **Массажные кресла**: Эти кресла предлагают разнообразные массажные функции, включая Shiatsu, роликовый массаж и различных режимов интенсивности, что позволяет настраивать массаж под ваши предпочтения. Они помогают снять напряжение и расслабить мышцы.\n\n2. **Реклайнеры**: Эти кресла могут наклоняться назад и обеспечивают хороший уровень комфорта. Они идеальны для отдыха и могут быть использованы как для просмотра телевизора, так и для сна.\n\n3. **Кресла-качалки**: Они обеспечивают плавное движение вперед-назад, что создает успокаивающий эффект и помогает расслабиться.\n\n4. **Кресла с подогревом**: Эти модели сочетает в себе массажные функции и подогрев, что еще больше усиливает эффект расслабления.\n\nПри выборе кресла рекомендуется учитывать следующие моменты:\n- **Массажные функции**: Если вы будете активно использовать массаж, присмотритесь к моделям с разнообразными режимами и возможностью настройки.\n- **Комфорт**: Обратите внимание на материал обивки и поддержку тела, чтобы кресло подходило вам по размеру.\n- **Дизайн**: Выбирайте кресло, которое гармонично впишется в ваш интерьер.\n\nИ наконец, если вы рассматриваете массажные кресла, следует выяснить, нужно ли вам больше массажных функций или вам достаточно простого кресла для отдыха. Какой тип кресла вас интересует больше?'}
18.10.2025 17:59:55 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 18:34:11 shutdown: Остановка приложения
18.10.2025 18:34:11 shutdown: Log корректно завершён
18.10.2025 18:34:16 startup: lifespan: startup начат
18.10.2025 18:34:16 startup: База инициализирована
18.10.2025 18:34:18 startup: Base добавлен в app.state
18.10.2025 18:34:18 startup: Async Log инициализирован
18.10.2025 18:34:23 shutdown: Остановка приложения
18.10.2025 18:34:23 shutdown: Log корректно завершён
18.10.2025 18:34:27 startup: lifespan: startup начат
18.10.2025 18:34:27 startup: База инициализирована
18.10.2025 18:34:28 startup: Base добавлен в app.state
18.10.2025 18:34:28 startup: Async Log инициализирован
18.10.2025 18:34:32 shutdown: Остановка приложения
18.10.2025 18:34:32 shutdown: Log корректно завершён
18.10.2025 18:48:53 startup: Импорты main.py выполнены
18.10.2025 18:48:53 startup: Запуск uvicorn.run
18.10.2025 18:48:57 startup: lifespan: startup начат
18.10.2025 18:48:57 startup: База инициализирована
18.10.2025 18:48:58 startup: Base добавлен в app.state
18.10.2025 18:48:58 startup: Async Log инициализирован
18.10.2025 18:48:59 auth: Токен выдан успешно: {'username': 'admin'}
18.10.2025 18:49:01 auth: Токен проверен: admin
18.10.2025 18:49:01 lead: Лид загружен: {'id': 1}
18.10.2025 18:49:01 lead: Лид обновлён: {'id': 1}
18.10.2025 18:49:01 dialog: Лид очищен: {'lead_id': 1}
18.10.2025 18:49:01 dialog: История диалога очищена: {'client_id': 1}
18.10.2025 18:49:12 auth: Токен проверен: admin
18.10.2025 18:49:12 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 18:49:12 lead: Лид загружен: {'id': 1}
18.10.2025 18:49:12 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 18:49:12 dialog_step: : {'user': 'Привет'}
18.10.2025 18:49:12 dialog: ERROR: Ошибка при обработке шага диалога: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s): {'client_id': 1}
18.10.2025 18:50:15 shutdown: Остановка приложения
18.10.2025 18:50:15 shutdown: Log корректно завершён
18.10.2025 18:50:19 startup: lifespan: startup начат
18.10.2025 18:50:19 startup: База инициализирована
18.10.2025 18:50:21 startup: Base добавлен в app.state
18.10.2025 18:50:21 startup: Async Log инициализирован
18.10.2025 18:51:02 auth: Токен проверен: admin
18.10.2025 18:51:02 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 18:51:03 lead: Лид загружен: {'id': 1}
18.10.2025 18:51:03 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 18:51:03 dialog_step: : {'user': 'Привет'}
18.10.2025 18:51:03 dialog: ERROR: Ошибка при обработке шага диалога: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s): {'client_id': 1}
18.10.2025 18:52:23 shutdown: Остановка приложения
18.10.2025 18:52:23 shutdown: Log корректно завершён
18.10.2025 18:52:27 startup: lifespan: startup начат
18.10.2025 18:52:27 startup: База инициализирована
18.10.2025 18:52:28 startup: Base добавлен в app.state
18.10.2025 18:52:28 startup: Async Log инициализирован
18.10.2025 18:52:28 auth: Токен проверен: admin
18.10.2025 18:52:28 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 18:52:28 lead: Лид загружен: {'id': 1}
18.10.2025 18:52:28 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 18:52:28 dialog_step: : {'user': 'Привет'}
18.10.2025 18:52:28 dialog: ERROR: Ошибка при обработке шага диалога: object NoneType can't be used in 'await' expression: {'client_id': 1}
18.10.2025 18:53:46 shutdown: Остановка приложения
18.10.2025 18:53:46 shutdown: Log корректно завершён
18.10.2025 18:53:49 startup: lifespan: startup начат
18.10.2025 18:53:49 startup: База инициализирована
18.10.2025 18:53:50 startup: Base добавлен в app.state
18.10.2025 18:53:50 startup: Async Log инициализирован
18.10.2025 18:53:54 auth: Токен проверен: admin
18.10.2025 18:53:54 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 18:53:54 lead: Лид загружен: {'id': 1}
18.10.2025 18:53:54 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 18:53:54 dialog_step: : {'user': 'Привет'}
18.10.2025 18:53:54 dialog: ERROR: Ошибка при обработке шага диалога: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s): {'client_id': 1}
18.10.2025 19:01:07 auth: Токен проверен: admin
18.10.2025 19:01:07 dialog: ERROR: Пустой user_input в диалоге: {'client_id': 1}
18.10.2025 19:01:13 shutdown: Остановка приложения
18.10.2025 19:01:13 shutdown: Log корректно завершён
18.10.2025 19:01:16 startup: lifespan: startup начат
18.10.2025 19:01:16 startup: База инициализирована
18.10.2025 19:01:18 startup: Base добавлен в app.state
18.10.2025 19:01:18 startup: Async Log инициализирован
18.10.2025 19:01:33 shutdown: Остановка приложения
18.10.2025 19:01:33 shutdown: Log корректно завершён
18.10.2025 19:01:37 startup: lifespan: startup начат
18.10.2025 19:01:37 startup: База инициализирована
18.10.2025 19:01:38 startup: Base добавлен в app.state
18.10.2025 19:01:38 startup: Async Log инициализирован
18.10.2025 19:01:43 auth: Токен проверен: admin
18.10.2025 19:01:43 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 19:01:43 lead: Лид загружен: {'id': 1}
18.10.2025 19:01:43 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 19:01:44 dialog_step: : {'user': 'Привет'}
18.10.2025 19:01:44 dialog: ERROR: Ошибка при обработке шага диалога: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s): {'client_id': 1}
18.10.2025 19:02:22 shutdown: Остановка приложения
18.10.2025 19:02:22 shutdown: Log корректно завершён
18.10.2025 19:02:26 startup: Импорты main.py выполнены
18.10.2025 19:02:27 startup: Запуск uvicorn.run
18.10.2025 19:02:30 startup: lifespan: startup начат
18.10.2025 19:02:30 startup: База инициализирована
18.10.2025 19:02:31 startup: Base добавлен в app.state
18.10.2025 19:02:31 startup: Async Log инициализирован
18.10.2025 19:02:32 auth: Токен проверен: admin
18.10.2025 19:02:32 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 19:02:32 lead: Лид загружен: {'id': 1}
18.10.2025 19:02:32 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 19:02:32 dialog_step: : {'user': 'Привет'}
18.10.2025 19:02:32 dialog: ERROR: Ошибка при обработке шага диалога: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s): {'client_id': 1}
18.10.2025 19:04:46 shutdown: Остановка приложения
18.10.2025 19:04:46 shutdown: Log корректно завершён
18.10.2025 19:04:56 startup: lifespan: startup начат
18.10.2025 19:04:56 startup: База инициализирована
18.10.2025 19:04:57 startup: Base добавлен в app.state
18.10.2025 19:04:57 startup: Async Log инициализирован
18.10.2025 19:04:57 auth: Токен проверен: admin
18.10.2025 19:04:57 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 19:04:57 lead: Лид загружен: {'id': 1}
18.10.2025 19:04:57 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 19:04:57 dialog_step: : {'user': 'Привет'}
18.10.2025 19:04:57 hello_stage: Сформирован промпт приветствия: {'step': 0, 'client_id': 1}
18.10.2025 19:04:57 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 19:04:58 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 19:05:00 dialog_step: : {'step_after': 1, 'motive': None}
18.10.2025 19:05:00 dialog_step: : {'model': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Каковы ваши предпочтения в выборе кресла?'}
18.10.2025 19:05:00 lead: Лид обновлён: {'id': 1}
18.10.2025 19:05:00 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Каковы ваши предпочтения в выборе кресла?'}
18.10.2025 19:05:00 dialog_step: END step(): {'result': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Каковы ваши предпочтения в выборе кресла?'}
18.10.2025 19:05:00 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 19:05:29 auth: Токен проверен: admin
18.10.2025 19:05:29 dialog: ERROR: Пустой user_input в диалоге: {'client_id': 1}
18.10.2025 19:05:50 auth: Токен проверен: admin
18.10.2025 19:05:50 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 19:05:50 lead: Лид загружен: {'id': 1}
18.10.2025 19:05:50 dialog_step: : {'step_before': 1, 'motive': None}
18.10.2025 19:05:50 dialog_step: : {'user': 'Привет'}
18.10.2025 19:05:50 hello_stage: Сформирован промпт приветствия: {'step': 1, 'client_id': 1}
18.10.2025 19:05:50 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 19:05:51 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 19:05:53 dialog_step: : {'step_after': 1, 'motive': None}
18.10.2025 19:05:53 dialog_step: : {'model': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Каковы ваши предпочтения в выборе кресла?'}
18.10.2025 19:05:53 lead: Лид обновлён: {'id': 1}
18.10.2025 19:05:53 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Каковы ваши предпочтения в выборе кресла?'}
18.10.2025 19:05:53 dialog_step: END step(): {'result': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Каковы ваши предпочтения в выборе кресла?'}
18.10.2025 19:05:53 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 19:13:16 shutdown: Остановка приложения
18.10.2025 19:13:16 shutdown: Log корректно завершён
18.10.2025 19:34:09 startup: Импорты main.py выполнены
18.10.2025 19:34:10 startup: Запуск uvicorn.run
18.10.2025 19:34:13 startup: lifespan: startup начат
18.10.2025 19:34:13 startup: База инициализирована
18.10.2025 19:34:14 startup: Base добавлен в app.state
18.10.2025 19:34:14 startup: Async Log инициализирован
18.10.2025 19:34:25 auth: Токен выдан успешно: {'username': 'admin'}
18.10.2025 19:34:29 auth: Токен проверен: admin
18.10.2025 19:34:29 lead: Лид загружен: {'id': 1}
18.10.2025 19:34:29 lead: Лид обновлён: {'id': 1}
18.10.2025 19:34:29 dialog: Лид очищен: {'lead_id': 1}
18.10.2025 19:34:29 dialog: История диалога очищена: {'client_id': 1}
18.10.2025 19:34:37 auth: Токен проверен: admin
18.10.2025 19:34:37 dialog_step: START step(): {'client_id': 1, 'user_input': 'Привет'}
18.10.2025 19:34:37 lead: Лид загружен: {'id': 1}
18.10.2025 19:34:37 dialog_step: : {'step_before': 0, 'motive': None}
18.10.2025 19:34:37 dialog_step: : {'user': 'Привет'}
18.10.2025 19:34:37 hello_stage: Сформирован промпт приветствия: {'step': 0, 'client_id': 1}
18.10.2025 19:34:37 dispatcher: Выбранный агент: hello: {'client_id': 1}
18.10.2025 19:34:39 dialog_step: Добавлен контекст из базы: {'chunks_count': 3}
18.10.2025 19:34:41 dialog_step: : {'step_after': 1, 'motive': None}
18.10.2025 19:34:41 dialog_step: : {'model': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Какие критерии выбора кресла для вас наиболее важны?'}
18.10.2025 19:34:41 lead: Лид обновлён: {'id': 1}
18.10.2025 19:34:41 dialog_step: Ассистентский ответ добавлен и сохранён: {'assistant_text': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Какие критерии выбора кресла для вас наиболее важны?'}
18.10.2025 19:34:41 dialog_step: END step(): {'result': 'Здравствуйте! Я — ваш виртуальный помощник Relaxio. Готов познакомить вас с нашими креслами. Какие критерии выбора кресла для вас наиболее важны?'}
18.10.2025 19:34:41 dialog: Шаг диалога обработан: {'client_id': 1}
18.10.2025 19:35:28 shutdown: Остановка приложения
18.10.2025 19:35:28 shutdown: Log корректно завершён
18.10.2025 21:58:14 startup: Импорты main.py выполнены
18.10.2025 21:58:14 startup: Запуск uvicorn.run
18.10.2025 21:58:18 startup: lifespan: startup начат
18.10.2025 21:58:19 startup: База инициализирована
18.10.2025 21:58:20 startup: Base добавлен в app.state
18.10.2025 21:58:20 startup: Async Log инициализирован
18.10.2025 21:59:54 lead: Лид создан: {'id': 2}
18.10.2025 22:00:50 lead: 2 лидов загружено
18.10.2025 22:00:50 auth: Пользователь успешно авторизован: {'user': {'id': 1, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$rEp4ug7d9FPeeYYu$Cxce.TCGURiPd0RG9wOq3orsg7aiOO3yo/3/2IKQr62', 'name': 'Administrator', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'admin', 'is_admin': True}}
18.10.2025 22:01:19 lead: 2 лидов загружено
18.10.2025 22:01:19 auth: Токен проверен: admin
18.10.2025 22:01:20 lead: Лид создан: {'id': 3}
18.10.2025 22:02:05 lead: 3 лидов загружено
18.10.2025 22:02:05 auth: Токен проверен: admin
18.10.2025 22:02:32 lead: 3 лидов загружено
18.10.2025 22:02:32 auth: Пользователь успешно авторизован: {'user': {'id': 2, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$/a4HjeEH6pT2yiib$twCymaQLfFmi749z8.Zw7f0QwfcZSIvnTCWGMFwvOFA', 'name': 'User', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'user', 'is_admin': False}}
18.10.2025 22:02:50 lead: 3 лидов загружено
18.10.2025 22:02:50 auth: Токен проверен: user
18.10.2025 22:03:07 lead: 3 лидов загружено
18.10.2025 22:03:08 auth: Пользователь успешно авторизован: {'user': {'id': 2, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$/a4HjeEH6pT2yiib$twCymaQLfFmi749z8.Zw7f0QwfcZSIvnTCWGMFwvOFA', 'name': 'User', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'user', 'is_admin': False}}
18.10.2025 22:03:08 lead: 3 лидов загружено
18.10.2025 22:03:08 auth: Токен проверен: user
18.10.2025 22:03:08 lead: Лид загружен: {'id': 2}
18.10.2025 22:03:18 lead: 3 лидов загружено
18.10.2025 22:03:19 auth: Пользователь успешно авторизован: {'user': {'id': 2, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$/a4HjeEH6pT2yiib$twCymaQLfFmi749z8.Zw7f0QwfcZSIvnTCWGMFwvOFA', 'name': 'User', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'user', 'is_admin': False}}
18.10.2025 22:03:19 lead: 3 лидов загружено
18.10.2025 22:03:19 auth: Токен проверен: user
18.10.2025 22:03:19 lead: Лид загружен: {'id': 2}
18.10.2025 22:04:22 lead: 3 лидов загружено
18.10.2025 22:04:23 auth: Пользователь успешно авторизован: {'user': {'id': 3, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$szvOv//YsKp1pOO2$vRUWUQkeYy0nVX5KYbzGkv32KFqiYZOuiDtJmTNACT4', 'name': 'User_2', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'user_2', 'is_admin': False}}
18.10.2025 22:04:23 lead: 3 лидов загружено
18.10.2025 22:04:23 auth: Токен проверен: user_2
18.10.2025 22:04:23 lead: Лид удалён: {'id': 3}
18.10.2025 22:04:37 lead: 2 лидов загружено
18.10.2025 22:04:38 auth: Пользователь успешно авторизован: {'user': {'id': 1, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$rEp4ug7d9FPeeYYu$Cxce.TCGURiPd0RG9wOq3orsg7aiOO3yo/3/2IKQr62', 'name': 'Administrator', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'admin', 'is_admin': True}}
18.10.2025 22:04:38 lead: 2 лидов загружено
18.10.2025 22:04:38 auth: Токен проверен: admin
18.10.2025 22:04:38 lead: 2 лидов загружено
18.10.2025 22:04:38 lead: 2 лидов загружено
18.10.2025 22:04:39 auth: Пользователь успешно авторизован: {'user': {'id': 2, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$/a4HjeEH6pT2yiib$twCymaQLfFmi749z8.Zw7f0QwfcZSIvnTCWGMFwvOFA', 'name': 'UpdatedUser1', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'user', 'is_admin': False}}
18.10.2025 22:04:39 lead: 2 лидов загружено
18.10.2025 22:04:39 auth: Токен проверен: user
18.10.2025 22:04:44 lead: 2 лидов загружено
18.10.2025 22:04:45 auth: Пользователь успешно авторизован: {'user': {'id': 2, 'log': None, 'model': None, 'offer': None, 'step': 0, 'password': '$5$rounds=535000$/a4HjeEH6pT2yiib$twCymaQLfFmi749z8.Zw7f0QwfcZSIvnTCWGMFwvOFA', 'name': 'UpdatedUser1', 'contact': None, 'motive': None, 'needs': None, 'timestamp': '<datetime>', 'login': 'user', 'is_admin': False}}
18.10.2025 22:04:45 lead: 2 лидов загружено
18.10.2025 22:04:45 auth: Токен проверен: user
18.10.2025 22:04:45 lead: Лид загружен: {'id': 2}
18.10.2025 22:04:45 lead: 2 лидов загружено
18.10.2025 22:04:45 auth: WARNING: Неудачная попытка входа: {'username': 'user2'}
18.10.2025 22:04:45 auth: ERROR: Ошибка при получении токена: 401: Неверный логин или пароль: {'username': 'user2'}
18.10.2025 22:04:45 lead: 2 лидов загружено
18.10.2025 22:04:45 auth: Токен проверен: user
